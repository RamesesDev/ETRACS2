<?xml version="1.0" encoding="UTF-8"?>
<workunit>
    <invokers>
        <invoker type="rpt.master" caption="Structures" index="8" />
        
        <invoker type="formActions" action="create" shortcut="ctrl N" immediate="true" caption="New" mnemonic="n" icon="images/doc-new.png" />
        <invoker type="formActions" action="open" shortcut="ctrl O" visibleWhen="#{selectedItem != null }" immediate="true" caption="Open" mnemonic="e" icon="images/open.png" />
        <invoker type="formActions" action="delete" shortcut="ctrl D" visibleWhen="#{selectedItem != null}" immediate="true" caption="Delete" mnemonic="d" icon="images/doc-delete.png" />
    </invokers>
    <code lang="groovy">
<![CDATA[        


import com.rameses.rcp.annotations.*
import com.rameses.rcp.common.*
import com.rameses.osiris2.client.*

public class StructuresMgmtController
{
    @Binding
    def binding
    
    @Service("StructuresService")
    def svc 
    
    def searchText
    def selectedItem
    def params
    
    def create() {
        return InvokerUtil.lookupOpener('structure.create', [:])
    }
    
    def open() {
        return InvokerUtil.lookupOpener('structure.open', [entity:selectedItem])
    }
    
    void delete() {
        if( selectedItem && MsgBox.confirm('Delete item?') ) {
            svc.delete( selectedItem )
            search()
        }
    }
    
    void search() {
        listHandler.load()
    }
    
    def listHandler = [
        getRows    : { return 50; },
        getColumns : {
            return [
                new Column(name:"structurecode", caption:"Code", minWidth:50),
                new Column(name:"structuredesc", caption:"Structure", minWidth:200)
            ];
        },
        fetchList : { return svc.getList( searchText, params ) },
    ] as SubListModel;
}

]]>
    </code>    
    
    <pages>
        <page template="etracs2.rpt.ry.RYListMgmtPage" />
    </pages>
</workunit>
