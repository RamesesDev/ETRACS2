import com.rameses.annotations.*;
import com.rameses.util.*;

class ETRACSUserService 
{

    @PersistenceContext("java:main")
    def em;
	
	@ProxyMethod
	public def getList( searchText, params ) {
		if( ! searchText ) return getListByName("etracsuser:getList", [:], params);
		def result = [];
		if( (result = getListByName("etracsuser:findByUid", [uid:searchText], params)) ) return result;
		if( (result = getListByName("etracsuser:findByLastName", [lastname:searchText+"%"], params)) ) return result;
		return result;
	}
    
	@ProxyMethod
	public void save( user ) {
		em.sqlContext.createNamedExecutor("etracsuser:updateInfo").setParameters(user).execute();
	}
	
	@ProxyMethod
	public Map getCollector( collectorid ) {
		return [collectorid:'COL01', collectorname:'SUSAN SANTOS', collectortitle:'RCC II']
	}
	
	@ProxyMethod
	public List getCollectorList() {
		return [
			[collectorid:'COL01', collectorname:'SUSAN SANTOS', collectortitle:'RCC II'],
			[collectorid:'COL02', collectorname:'MIGUEL TAN', collectortitle:'RCC I'],
		]
	}
	
	@ProxyMethod
	public def getLiquidatingOfficer( liqofficerid ) {
		return [liqofficerid:'LIQ01', liqofficername:'EUGENE YU', liqofficer:'TREASURER'];
	}
	
	private def getListByName( namedQuery, values, params ) {
		return em.sqlContext.createNamedQuery( namedQuery )
					.setParameters(values)
					.setFirstResult( params._start )
					.setMaxResults( params._limit )
					.resultList;
	}
	
	
    
}
